import e from"regenerator-runtime/runtime";var t={};Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"KPuzzleDefinition",{enumerable:!0,get:function(){return r.KPuzzleDefinition}}),Object.defineProperty(t,"Transformation",{enumerable:!0,get:function(){return r.Transformation}}),Object.defineProperty(t,"KPuzzle",{enumerable:!0,get:function(){return n.KPuzzle}}),Object.defineProperty(t,"stateForBlockMove",{enumerable:!0,get:function(){return n.stateForBlockMove}}),Object.defineProperty(t,"Canonicalize",{enumerable:!0,get:function(){return Nt.Canonicalize}}),Object.defineProperty(t,"SearchSequence",{enumerable:!0,get:function(){return Nt.SearchSequence}}),Object.defineProperty(t,"CanonicalSequenceIterator",{enumerable:!0,get:function(){return Nt.CanonicalSequenceIterator}}),Object.defineProperty(t,"Combine",{enumerable:!0,get:function(){return At.Combine}}),Object.defineProperty(t,"Multiply",{enumerable:!0,get:function(){return At.Multiply}}),Object.defineProperty(t,"IdentityTransformation",{enumerable:!0,get:function(){return At.IdentityTransformation}}),Object.defineProperty(t,"Invert",{enumerable:!0,get:function(){return At.Invert}}),Object.defineProperty(t,"EquivalentTransformations",{enumerable:!0,get:function(){return At.EquivalentTransformations}}),Object.defineProperty(t,"EquivalentStates",{enumerable:!0,get:function(){return At.EquivalentStates}}),Object.defineProperty(t,"Order",{enumerable:!0,get:function(){return At.Order}}),Object.defineProperty(t,"Puzzles",{enumerable:!0,get:function(){return Vt.Puzzles}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return or.parse}}),Object.defineProperty(t,"SVG",{enumerable:!0,get:function(){return vr.SVG}});var r={},n={};Object.defineProperty(n,"__esModule",{value:!0});var o=zt;n.stateForBlockMove=o;var a=void 0;n.KPuzzle=a;var i={};Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"AlgPart",{enumerable:!0,get:function(){return s.AlgPart}}),Object.defineProperty(i,"Unit",{enumerable:!0,get:function(){return s.Unit}}),Object.defineProperty(i,"WithAmount",{enumerable:!0,get:function(){return s.WithAmount}}),Object.defineProperty(i,"Move",{enumerable:!0,get:function(){return s.Move}}),Object.defineProperty(i,"Container",{enumerable:!0,get:function(){return s.Container}}),Object.defineProperty(i,"Annotation",{enumerable:!0,get:function(){return s.Annotation}}),Object.defineProperty(i,"Sequence",{enumerable:!0,get:function(){return s.Sequence}}),Object.defineProperty(i,"Group",{enumerable:!0,get:function(){return s.Group}}),Object.defineProperty(i,"MoveFamily",{enumerable:!0,get:function(){return s.MoveFamily}}),Object.defineProperty(i,"BlockMove",{enumerable:!0,get:function(){return s.BlockMove}}),Object.defineProperty(i,"BareBlockMove",{enumerable:!0,get:function(){return s.BareBlockMove}}),Object.defineProperty(i,"LayerBlockMove",{enumerable:!0,get:function(){return s.LayerBlockMove}}),Object.defineProperty(i,"RangeBlockMove",{enumerable:!0,get:function(){return s.RangeBlockMove}}),Object.defineProperty(i,"Commutator",{enumerable:!0,get:function(){return s.Commutator}}),Object.defineProperty(i,"Conjugate",{enumerable:!0,get:function(){return s.Conjugate}}),Object.defineProperty(i,"Pause",{enumerable:!0,get:function(){return s.Pause}}),Object.defineProperty(i,"NewLine",{enumerable:!0,get:function(){return s.NewLine}}),Object.defineProperty(i,"Comment",{enumerable:!0,get:function(){return s.Comment}}),Object.defineProperty(i,"modifiedBlockMove",{enumerable:!0,get:function(){return V.modifiedBlockMove}}),Object.defineProperty(i,"experimentalAppendBlockMove",{enumerable:!0,get:function(){return V.experimentalAppendBlockMove}}),Object.defineProperty(i,"experimentalConcatAlgs",{enumerable:!0,get:function(){return V.experimentalConcatAlgs}}),Object.defineProperty(i,"TraversalDownUp",{enumerable:!0,get:function(){return H.TraversalDownUp}}),Object.defineProperty(i,"TraversalUp",{enumerable:!0,get:function(){return H.TraversalUp}}),Object.defineProperty(i,"invert",{enumerable:!0,get:function(){return H.invert}}),Object.defineProperty(i,"expand",{enumerable:!0,get:function(){return H.expand}}),Object.defineProperty(i,"structureEquals",{enumerable:!0,get:function(){return H.structureEquals}}),Object.defineProperty(i,"coalesceBaseMoves",{enumerable:!0,get:function(){return H.coalesceBaseMoves}}),Object.defineProperty(i,"algToString",{enumerable:!0,get:function(){return H.algToString}}),Object.defineProperty(i,"algPartToStringForTesting",{enumerable:!0,get:function(){return H.algPartToStringForTesting}}),Object.defineProperty(i,"blockMoveToString",{enumerable:!0,get:function(){return H.blockMoveToString}}),Object.defineProperty(i,"AlgJSON",{enumerable:!0,get:function(){return ke.AlgJSON}}),Object.defineProperty(i,"fromJSON",{enumerable:!0,get:function(){return ke.fromJSON}}),Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return Te.parse}}),Object.defineProperty(i,"keyToMove",{enumerable:!0,get:function(){return lt.keyToMove}}),Object.defineProperty(i,"validateSiGNMoves",{enumerable:!0,get:function(){return ze.validateSiGNMoves}}),Object.defineProperty(i,"validateFlatAlg",{enumerable:!0,get:function(){return ze.validateFlatAlg}}),Object.defineProperty(i,"validateSiGNAlg",{enumerable:!0,get:function(){return ze.validateSiGNAlg}}),Object.defineProperty(i,"ValidationError",{enumerable:!0,get:function(){return ze.ValidationError}}),Object.defineProperty(i,"serializeURLParam",{enumerable:!0,get:function(){return ht.serializeURLParam}}),Object.defineProperty(i,"deserializeURLParam",{enumerable:!0,get:function(){return ht.deserializeURLParam}}),Object.defineProperty(i,"algCubingNetLink",{enumerable:!0,get:function(){return ht.algCubingNetLink}}),Object.defineProperty(i,"getAlgURLParam",{enumerable:!0,get:function(){return ht.getAlgURLParam}}),Object.defineProperty(i,"setAlgPartTypeMismatchReportingLevel",{enumerable:!0,get:function(){return m.setAlgPartTypeMismatchReportingLevel}});var s={};Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"AlgPartType",{enumerable:!0,get:function(){return u.AlgPartType}}),Object.defineProperty(s,"AlgPart",{enumerable:!0,get:function(){return u.AlgPart}}),Object.defineProperty(s,"Unit",{enumerable:!0,get:function(){return u.Unit}}),Object.defineProperty(s,"Move",{enumerable:!0,get:function(){return u.Move}}),Object.defineProperty(s,"Annotation",{enumerable:!0,get:function(){return u.Annotation}}),Object.defineProperty(s,"Container",{enumerable:!0,get:function(){return u.Container}}),Object.defineProperty(s,"WithAmount",{enumerable:!0,get:function(){return u.WithAmount}}),Object.defineProperty(s,"Sequence",{enumerable:!0,get:function(){return u.Sequence}}),Object.defineProperty(s,"Group",{enumerable:!0,get:function(){return u.Group}}),Object.defineProperty(s,"Commutator",{enumerable:!0,get:function(){return u.Commutator}}),Object.defineProperty(s,"Conjugate",{enumerable:!0,get:function(){return u.Conjugate}}),Object.defineProperty(s,"Pause",{enumerable:!0,get:function(){return u.Pause}}),Object.defineProperty(s,"NewLine",{enumerable:!0,get:function(){return u.NewLine}}),Object.defineProperty(s,"Comment",{enumerable:!0,get:function(){return u.Comment}}),Object.defineProperty(s,"MoveFamily",{enumerable:!0,get:function(){return N.MoveFamily}}),Object.defineProperty(s,"BlockMove",{enumerable:!0,get:function(){return N.BlockMove}}),Object.defineProperty(s,"BareBlockMove",{enumerable:!0,get:function(){return N.BareBlockMove}}),Object.defineProperty(s,"LayerBlockMove",{enumerable:!0,get:function(){return N.LayerBlockMove}}),Object.defineProperty(s,"RangeBlockMove",{enumerable:!0,get:function(){return N.RangeBlockMove}});var u={};Object.defineProperty(u,"__esModule",{value:!0});var c=A;u.matchesAlgType=c;var l=function(e,t){A(e,t)||(0,m.reportTypeMismatch)(`Expected "type": "${t}", saw "type": "${e.type}".`);return e};u.assertMatchesType=l;var f=function(e){if(!("type"in e))return!1;return!A(e,"sequence")};u.isUnit=f;var v=P;u.assertIsUnit=v;var h=(M=void 0,x=u.AlgPart=M,j=u.Unit=x,O=u.Move=j,q=u.Annotation=O,L=u.Container=q,T=u.Sequence=L,E=u.Group=T,U=u.Commutator=E,z=u.Conjugate=U,_=u.Pause=z,u.NewLine=_);u.Comment=h;var m={};Object.defineProperty(m,"__esModule",{value:!0});var p=function(e){switch(g){case"error":throw new Error(e);case"warn":return y++,void(y<10&&y+1===10&&console.warn(e))}};m.reportTypeMismatch=p;var d=function(e){g=e};m.setAlgPartTypeMismatchReportingLevel=d;let g="warn";let y=0;function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class w{constructor(){b(this,"type",void 0)}}var M=w;function A(e,t){return e.type===t}function P(e){return"type"in e||(0,m.reportTypeMismatch)('Expected "unit", saw a value that was not an AlgPart.'),A(e,"sequence")&&(0,m.reportTypeMismatch)('Expected unit, saw "sequence".'),e}u.AlgPart=M;class S extends w{}var x=S;u.Unit=x;class B extends S{}var j=B;u.Move=j;class C extends S{}var O=C;u.Annotation=O;class k extends S{}var q=k;u.Container=q;var L=class extends w{constructor(e){super(),this.nestedUnits=e,b(this,"type","sequence");for(const t of e)P(t);Object.freeze(this.nestedUnits),Object.freeze(this)}};u.Sequence=L;var T=class extends k{constructor(e,t=1){super(),this.nestedSequence=e,this.amount=t,b(this,"type","group"),Object.freeze(this)}};u.Group=T;var E=class extends k{constructor(e,t,r=1){super(),this.A=e,this.B=t,this.amount=r,b(this,"type","commutator"),Object.freeze(this)}};u.Commutator=E;var U=class extends k{constructor(e,t,r=1){super(),this.A=e,this.B=t,this.amount=r,b(this,"type","conjugate"),Object.freeze(this)}};u.Conjugate=U;var z=class extends B{constructor(){super(),b(this,"type","pause"),Object.freeze(this)}};u.Pause=z;var _=class extends C{constructor(){super(),b(this,"type","newLine"),Object.freeze(this)}};u.NewLine=_;h=class extends C{constructor(e){super(),this.comment=e,b(this,"type","comment"),Object.freeze(this)}},u.Comment=h;var N={};Object.defineProperty(N,"__esModule",{value:!0});var I=function(e,t){return new $(void 0,void 0,e,t)};N.BareBlockMove=I;var F=function(e,t,r){return new $(void 0,e,t,r)};N.LayerBlockMove=F;var G=function(e,t,r,n){return new $(e,t,r,n)};N.RangeBlockMove=G;var R=void 0;function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}N.BlockMove=R;class $ extends u.Move{constructor(e,t,r,n=1){if(super(),this.family=r,this.amount=n,D(this,"type","blockMove"),D(this,"outerLayer",void 0),D(this,"innerLayer",void 0),t&&(this.innerLayer=t,e&&(this.outerLayer=e)),e&&!t)throw new Error("Attempted to contruct block move with outer layer but no inner layer");Object.freeze(this)}}R=$,N.BlockMove=R;var V={};Object.defineProperty(V,"__esModule",{value:!0});var Z=J;V.modifiedBlockMove=Z;var K=function(e,t,r=!1,n=0){const o=e.nestedUnits,a=o[o.length-1];if(r&&a&&(u=t,(i=a).family===u.family&&i.innerLayer===u.innerLayer&&i.outerLayer===u.outerLayer)){const r=e.nestedUnits.slice(0,o.length-1);let i=a.amount+t.amount;return n>1&&(i=(i%n+n)%n,2*i>n&&(i-=n)),0!==i&&r.push(J(a,{amount:i})),new s.Sequence(r)}return new s.Sequence([...o,t]);var i,u};V.experimentalAppendBlockMove=K;var W=function(...e){return new s.Sequence(Array.prototype.concat.apply([],[...e].map(e=>e.nestedUnits)))};function J(e,t){var r,n,o,a;return new s.BlockMove(null!==(r=t.outerLayer)&&void 0!==r?r:e.outerLayer,null!==(n=t.innerLayer)&&void 0!==n?n:e.innerLayer,null!==(o=t.family)&&void 0!==o?o:e.family,null!==(a=t.amount)&&void 0!==a?a:e.amount)}V.experimentalConcatAlgs=W;var H={};Object.defineProperty(H,"__esModule",{value:!0});var Q=me;H.blockMoveToString=Q;var X=function(e){return Oe(new s.BlockMove(e.outerLayer,e.innerLayer,e.family,1))};H.experimentalBlockMoveQuantumName=X;var Y=(re=void 0,oe=H.TraversalDownUp=re,ie=H.TraversalUp=oe,ue=H.Invert=ie,le=H.Expand=ue,ve=H.StructureEquals=le,de=H.CoalesceBaseMoves=ve,Pe=H.ToString=de,Se=H.invert=Pe,xe=H.expand=Se,Be=H.structureEquals=xe,je=H.coalesceBaseMoves=Be,Ce=H.algToString=je,H.algPartStructureEqualsForTesting=Ce);function ee(e,t,r){switch(t.type){case"sequence":return(0,u.assertMatchesType)(t,"sequence"),e.traverseSequence(t,r);case"group":return(0,u.assertMatchesType)(t,"group"),e.traverseGroup(t,r);case"blockMove":return(0,u.assertMatchesType)(t,"blockMove"),e.traverseBlockMove(t,r);case"commutator":return(0,u.assertMatchesType)(t,"commutator"),e.traverseCommutator(t,r);case"conjugate":return(0,u.assertMatchesType)(t,"conjugate"),e.traverseConjugate(t,r);case"pause":return(0,u.assertMatchesType)(t,"pause"),e.traversePause(t,r);case"newLine":return(0,u.assertMatchesType)(t,"newLine"),e.traverseNewLine(t,r);case"comment":return(0,u.assertMatchesType)(t,"comment"),e.traverseComment(t,r);default:throw new Error(`Unknown AlgPart type: ${t.type}`)}}H.algPartToStringForTesting=Y;class te{traverse(e,t){return ee(this,e,t)}traverseIntoUnit(e,t){return(0,u.assertIsUnit)(this.traverse(e,t))}}var re=te;H.TraversalDownUp=re;class ne extends te{traverse(e){return ee(this,e,void 0)}traverseIntoUnit(e){return(0,u.assertIsUnit)(this.traverse(e))}}var oe=ne;H.TraversalUp=oe;class ae extends ne{traverseSequence(e){return new s.Sequence(e.nestedUnits.map(e=>this.traverseIntoUnit(e)).reverse())}traverseGroup(e){return new s.Group(this.traverseSequence(e.nestedSequence),e.amount)}traverseBlockMove(e){return new s.BlockMove(e.outerLayer,e.innerLayer,e.family,-e.amount)}traverseCommutator(e){return new s.Commutator(e.B,e.A,e.amount)}traverseConjugate(e){return new s.Conjugate(e.A,this.traverseSequence(e.B),e.amount)}traversePause(e){return e}traverseNewLine(e){return e}traverseComment(e){return e}}var ie=ae;H.Invert=ie;class se extends ne{traverseSequence(e){return new s.Sequence(this.flattenSequenceOneLevel(e.nestedUnits.map(e=>this.traverse(e))))}traverseGroup(e){return this.repeat(this.flattenSequenceOneLevel([this.traverse(e.nestedSequence)]),e)}traverseBlockMove(e){return e}traverseCommutator(e){const t=this.traverseSequence(e.A),r=this.traverseSequence(e.B);let n=[];return n=n.concat(t,r,Ae(t),Ae(r)),this.repeat(this.flattenSequenceOneLevel(n),e)}traverseConjugate(e){const t=this.traverseSequence(e.A),r=this.traverseSequence(e.B);let n=[];return n=n.concat(t,r,Ae(t)),this.repeat(this.flattenSequenceOneLevel(n),e)}traversePause(e){return e}traverseNewLine(e){return e}traverseComment(e){return e}flattenSequenceOneLevel(e){let t=[];for(const r of e)if((0,u.matchesAlgType)(r,"sequence"))t=t.concat(r.nestedUnits);else{if(!(0,u.isUnit)(r))throw new Error("expand() encountered an internal error. Did you pass in a valid Algorithm?");t.push(r)}return t}repeat(e,t){const r=Math.abs(t.amount);let n;n=-1===(t.amount>0?1:-1)?Ae(new s.Sequence(e)).nestedUnits:e;let o=[];for(let e=0;e<r;e++)o=o.concat(n);return new s.Sequence(o)}}var ue=se;H.Expand=ue;class ce extends te{traverseSequence(e,t){if((0,u.isUnit)(t))return!1;const r=t;if(e.nestedUnits.length!==r.nestedUnits.length)return!1;for(let t=0;t<e.nestedUnits.length;t++)if(!this.traverse(e.nestedUnits[t],r.nestedUnits[t]))return!1;return!0}traverseGroup(e,t){return(0,u.matchesAlgType)(t,"group")&&this.traverse(e.nestedSequence,t.nestedSequence)}traverseBlockMove(e,t){return(0,u.matchesAlgType)(t,"blockMove")&&e.outerLayer===t.outerLayer&&e.innerLayer===t.innerLayer&&e.family===t.family&&e.amount===t.amount}traverseCommutator(e,t){return(0,u.matchesAlgType)(t,"commutator")&&this.traverse(e.A,t.A)&&this.traverse(e.B,t.B)}traverseConjugate(e,t){return(0,u.matchesAlgType)(t,"conjugate")&&this.traverse(e.A,t.A)&&this.traverse(e.B,t.B)}traversePause(e,t){return(0,u.matchesAlgType)(t,"pause")}traverseNewLine(e,t){return(0,u.matchesAlgType)(t,"newLine")}traverseComment(e,t){return(0,u.matchesAlgType)(t,"comment")&&e.comment===t.comment}}var le=ce;H.StructureEquals=le;class fe extends ne{traverseSequence(e){const t=[];for(const r of e.nestedUnits)if((0,u.matchesAlgType)(r,"blockMove"))if(t.length>0){const e=t[t.length-1];if((0,u.matchesAlgType)(e,"blockMove")&&this.sameBlock(e,r)){const n=e.amount+r.amount;t.pop(),0!==n&&t.push(new s.BlockMove(r.outerLayer,r.innerLayer,r.family,n))}else t.push(r)}else t.push(r);else t.push(this.traverseIntoUnit(r));return new s.Sequence(t)}traverseGroup(e){return e}traverseBlockMove(e){return e}traverseCommutator(e){return e}traverseConjugate(e){return e}traversePause(e){return e}traverseNewLine(e){return e}traverseComment(e){return e}sameBlock(e,t){return e.outerLayer===t.outerLayer&&e.innerLayer===t.innerLayer&&e.family===t.family}}var ve=fe;function he(e){const t=Math.abs(e);let r="";return 1!==t&&(r+=String(t)),t!==e&&(r+="'"),r}function me(e){let t=e.family+he(e.amount);return void 0!==e.innerLayer&&(t=String(e.innerLayer)+t,void 0!==e.outerLayer&&(t=String(e.outerLayer)+"-"+t)),t}H.CoalesceBaseMoves=ve;class pe extends ne{traverseSequence(e){let t="";if(e.nestedUnits.length>0){t+=this.traverse(e.nestedUnits[0]);for(let r=1;r<e.nestedUnits.length;r++)t+=this.spaceBetween(e.nestedUnits[r-1],e.nestedUnits[r]),t+=this.traverse(e.nestedUnits[r])}return t}traverseGroup(e){return"("+this.traverse(e.nestedSequence)+")"+he(e.amount)}traverseBlockMove(e){return me(e)}traverseCommutator(e){return"["+this.traverse(e.A)+", "+this.traverse(e.B)+"]"+he(e.amount)}traverseConjugate(e){return"["+this.traverse(e.A)+": "+this.traverse(e.B)+"]"+he(e.amount)}traversePause(e){return"."}traverseNewLine(e){return"\n"}traverseComment(e){return"//"+e.comment}spaceBetween(e,t){return(0,u.matchesAlgType)(e,"pause")&&(0,u.matchesAlgType)(t,"pause")||(0,u.matchesAlgType)(e,"newLine")||(0,u.matchesAlgType)(t,"newLine")?"":(0,u.matchesAlgType)(e,"comment")&&!(0,u.matchesAlgType)(t,"newLine")?"\n":" "}}var de=pe;H.ToString=de;const ge=new ae,ye=new se,be=new ce,we=new fe,Me=new pe,Ae=ge.traverseSequence.bind(ge);var Pe=Ae;H.invert=Pe;var Se=ye.traverseSequence.bind(ye);H.expand=Se;var xe=be.traverseSequence.bind(be);H.structureEquals=xe;var Be=we.traverseSequence.bind(we);H.coalesceBaseMoves=Be;var je=Me.traverseSequence.bind(Me);H.algToString=je;var Ce=Me.traverse.bind(Me);H.algPartStructureEqualsForTesting=Ce;const Oe=Me.traverse.bind(Me);Y=Oe,H.algPartToStringForTesting=Y;var ke={};Object.defineProperty(ke,"__esModule",{value:!0});var qe=Le;function Le(e){if("sequence"!==e.type)throw new Error(`Expected Sequence while parsing, got: ${e.type}`);if(!e.nestedUnits)throw new Error("Missing nestedUnits");return new s.Sequence(e.nestedUnits.map(e=>function(e){switch(e.type){case"sequence":throw new Error("Expected AlgPart while parsing, got `Sequence`.");case"group":if(!e.nestedSequence)throw new Error("Missing nestedSequence");if(!e.amount)throw new Error("Missing amount");return new s.Group(Le(e.nestedSequence),e.amount);case"blockMove":if(!e.family)throw new Error("Missing family");if(!e.amount)throw new Error("Missing amount");return new s.BlockMove(e.outerLayer,e.innerLayer,e.family,e.amount);case"commutator":if(!e.A)throw new Error("Missing A");if(!e.B)throw new Error("Missing B");if(!e.amount)throw new Error("Missing amount");return new s.Commutator(Le(e.A),Le(e.B),e.amount);case"conjugate":if(!e.A)throw new Error("Missing A");if(!e.B)throw new Error("Missing B");if(!e.amount)throw new Error("Missing amount");return new s.Conjugate(Le(e.A),Le(e.B),e.amount);case"pause":return new s.Pause;case"newLine":return new s.NewLine;case"comment":if(!e.comment&&""!==e.comment)throw new Error("Missing comment");return new s.Comment(e.comment);default:throw new Error(`Unknown alg type: ${e.type}`)}}(e)))}ke.fromJSON=qe;var Te={};Object.defineProperty(Te,"__esModule",{value:!0});var Ee=ct;Te.parse=Ee;var Ue=function(e){return ct(e,{validators:[ze.validateSiGNAlg]})};Te.parseSiGN=Ue;var ze={};Object.defineProperty(ze,"__esModule",{value:!0});var _e=function(e){Ye(e),rt(e)};ze.validateSiGNAlg=_e;var Ne=(Fe=void 0,Re=ze.ValidationError=Fe,Je=ze.ValidatorTraversal=Re,Qe=ze.BlockMoveValidator=Je,et=ze.FlatAlgValidator=Qe,ze.validateSiGNMoves=et);ze.validateFlatAlg=Ne;class Ie extends Error{}var Fe=Ie;ze.ValidationError=Fe;class Ge extends H.TraversalUp{}var Re=Ge;function De(e,t){for(const r of t)if(!0===r[e])return!0;return!1}ze.ValidatorTraversal=Re;const $e={x:!0,y:!0,z:!0,M:!0,E:!0,S:!0,m:!0,e:!0,s:!0},Ve={U:!0,L:!0,F:!0,R:!0,B:!0,D:!0},Ze={u:!0,l:!0,f:!0,r:!0,b:!0,d:!0,Uw:!0,Lw:!0,Fw:!0,Rw:!0,Bw:!0,Dw:!0};class Ke extends Ge{traverseSequence(e){for(const t of e.nestedUnits)this.traverse(t)}traverseGroup(e){return this.traverse(e.nestedSequence)}traverseCommutator(e){this.traverse(e.A),this.traverse(e.B)}traverseConjugate(e){this.traverse(e.A),this.traverse(e.B)}traversePause(e){}traverseNewLine(e){}traverseComment(e){}}class We extends Ke{traverseBlockMove(e){if(void 0===e.outerLayer)if(void 0===e.innerLayer){if(!De(e.family,[Ze,Ve,$e]))throw new Ie(`Invalid SiGN plain move family: ${e.family}`)}else{if(!De(e.family,[Ze,Ve]))throw new Ie(`The provided SiGN move family is invalid, or cannot have an inner slice: ${e.family}`);if(e.innerLayer<=0)throw new Ie("Cannot have an inner layer of 0 or less.")}else{if(void 0===e.innerLayer)throw new Ie("A BlockMove with an outer layer must have an inner layer.");if(!De(e.family,[Ze]))throw new Ie(`The provided SiGN move family is invalid, or cannot have an outer and inner layer: ${e.family}`);if(e.outerLayer<=0)throw new Ie("Cannot have an outer layer of 0 or less.");if(e.outerLayer>=e.innerLayer)throw new Ie("The outer layer must be less than the inner layer.")}}}var Je=We;ze.BlockMoveValidator=Je;class He extends Ge{traverseSequence(e){for(const t of e.nestedUnits)this.traverse(t)}traverseGroup(e){throw new Ie("A flat alg cannot contain a group.")}traverseBlockMove(e){}traverseCommutator(e){throw new Ie("A flat alg cannot contain a commutator.")}traverseConjugate(e){throw new Ie("A flat alg cannot contain a conjugate.")}traversePause(e){}traverseNewLine(e){}traverseComment(e){}}var Qe=He;ze.FlatAlgValidator=Qe;const Xe=new We,Ye=Xe.traverse.bind(Xe);var et=Ye;ze.validateSiGNMoves=et;const tt=new He,rt=tt.traverse.bind(tt);Ne=rt,ze.validateFlatAlg=Ne;var nt={};Object.defineProperty(nt,"__esModule",{value:!0});var ot=void 0;nt.parse=ot;function at(e,t,r,n){this.message=e,this.expected=t,this.found=r,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,at)}!function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(at,Error),at.buildMessage=function(e,t){var r={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?a(e.parts[t][0])+"-"+a(e.parts[t][1]):a(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,o,a=new Array(e.length);for(t=0;t<e.length;t++)a[t]=(o=e[t],r[o.type](o));if(a.sort(),a.length>0){for(t=1,n=1;t<a.length;t++)a[t-1]!==a[t]&&(a[n]=a[t],n++);a.length=n}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."};var it,st=(it={SyntaxError:at,parse:function(e,t){t=void 0!==t?t:{};var r,n={},o={start:z},a=z,i=/^[0-9]/,s=q([["0","9"]],!1,!1),u=k("'",!1),c=/^[_A-Za-z]/,l=q(["_",["A","Z"],["a","z"]],!1,!1),f=k("-",!1),v=k("[",!1),h=/^[,:]/,m=q([",",":"],!1,!1),p=k("]",!1),d=k("(",!1),g=k(")",!1),y=k("//",!1),b=/^[^\n\r]/,w=q(["\n","\r"],!0,!1),M=/^[\n\r]/,A=q(["\n","\r"],!1,!1),P=k(".",!1),S=/^[ ]/,x=q([" "],!1,!1),B=0,j=[{line:1,column:1}],C=0,O=[];if("startRule"in t){if(!(t.startRule in o))throw new Error("Can't start parsing from rule \""+t.startRule+'".');a=o[t.startRule]}function k(e,t){return{type:"literal",text:e,ignoreCase:t}}function q(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function L(t){var r,n=j[t];if(n)return n;for(r=t-1;!j[r];)r--;for(n={line:(n=j[r]).line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return j[t]=n,n}function T(e,t){var r=L(e),n=L(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function E(e){B<C||(B>C&&(C=B,O=[]),O.push(e))}function U(e,t,r){return new at(at.buildMessage(e,t),e,t,r)}function z(){return $()}function _(){var t,r,o;if(t=B,r=[],i.test(e.charAt(B))?(o=e.charAt(B),B++):(o=n,E(s)),o!==n)for(;o!==n;)r.push(o),i.test(e.charAt(B))?(o=e.charAt(B),B++):(o=n,E(s));else r=n;return r!==n&&(t,r=parseInt(r.join(""),10)),t=r}function N(){var t,r,o;if(t=B,r=[],c.test(e.charAt(B))?(o=e.charAt(B),B++):(o=n,E(l)),o!==n)for(;o!==n;)r.push(o),c.test(e.charAt(B))?(o=e.charAt(B),B++):(o=n,E(l));else r=n;return r!==n&&(t,r=r.join("")),t=r}function I(){var t,r,o,a,i,s;return(t=function(){var t,r,o,a,i;return t=B,(r=N())!==n&&(t,r={type:"blockMove",family:r}),(t=r)===n&&(t=B,(r=_())!==n&&(o=N())!==n?(t,t=r=function(e,t){return{type:"blockMove",family:t,innerLayer:e}}(r,o)):(B=t,t=n),t===n&&(t=B,(r=_())!==n?(45===e.charCodeAt(B)?(o="-",B++):(o=n,E(f)),o!==n&&(a=_())!==n&&(i=N())!==n?(t,t=r=function(e,t,r){return{type:"blockMove",family:r,outerLayer:e,innerLayer:t}}(r,a,i)):(B=t,t=n)):(B=t,t=n))),t}())===n&&(t=B,91===e.charCodeAt(B)?(r="[",B++):(r=n,E(v)),r!==n&&(o=$())!==n?(h.test(e.charAt(B))?(a=e.charAt(B),B++):(a=n,E(m)),a!==n&&(i=$())!==n?(93===e.charCodeAt(B)?(s="]",B++):(s=n,E(p)),s!==n?(t,t=r={type:","===a?"commutator":"conjugate",A:o,B:i}):(B=t,t=n)):(B=t,t=n)):(B=t,t=n),t===n&&(t=B,40===e.charCodeAt(B)?(r="(",B++):(r=n,E(d)),r!==n&&(o=$())!==n?(41===e.charCodeAt(B)?(a=")",B++):(a=n,E(g)),a!==n?(t,t=r={type:"group",nestedSequence:o}):(B=t,t=n)):(B=t,t=n))),t}function F(){var t,r,o,a,i;return t=B,(r=I())!==n&&(o=function(){var t,r,o;return t=B,(r=_())!==n?(39===e.charCodeAt(B)?(o="'",B++):(o=n,E(u)),o!==n?(t,t=r=-r):(B=t,t=n)):(B=t,t=n),t===n&&(t=_())===n&&(t=B,39===e.charCodeAt(B)?(r="'",B++):(r=n,E(u)),r!==n&&(t,r=-1),t=r),t}())!==n?(t,i=o,(a=r).amount=i,t=r=a):(B=t,t=n),t===n&&(t=B,(r=I())!==n&&(t,r=function(e){return e.amount=1,e}(r)),t=r),t}function G(){var t,r;return t=B,M.test(e.charAt(B))?(r=e.charAt(B),B++):(r=n,E(A)),r!==n&&(t,r={type:"newLine"}),(t=r)===n&&(t=B,46===e.charCodeAt(B)?(r=".",B++):(r=n,E(P)),r!==n&&(t,r={type:"pause"}),(t=r)===n&&(t=function(){var t,r,o,a;if(t=B,"//"===e.substr(B,2)?(r="//",B+=2):(r=n,E(y)),r!==n){for(o=[],b.test(e.charAt(B))?(a=e.charAt(B),B++):(a=n,E(w));a!==n;)o.push(a),b.test(e.charAt(B))?(a=e.charAt(B),B++):(a=n,E(w));o!==n?(t,t=r={type:"comment",comment:o.join("")}):(B=t,t=n)}else B=t,t=n;return t}())),t}function R(){var e;return(e=F())===n&&(e=G()),e}function D(){var e,t,r;return e=B,(t=R())!==n&&(r=D())!==n?(e,e=t=[t].concat(r)):(B=e,e=n),e===n&&(e=B,(t=R())!==n&&(e,t=function(e){return[e]}(t)),e=t),e}function $(){var t,r,o,a,i;for(t=B,r=[],S.test(e.charAt(B))?(o=e.charAt(B),B++):(o=n,E(x));o!==n;)r.push(o),S.test(e.charAt(B))?(o=e.charAt(B),B++):(o=n,E(x));if(r!==n)if((o=function t(){var r,o,a,i,s;if(r=B,(o=D())!==n){if(a=[],S.test(e.charAt(B))?(i=e.charAt(B),B++):(i=n,E(x)),i!==n)for(;i!==n;)a.push(i),S.test(e.charAt(B))?(i=e.charAt(B),B++):(i=n,E(x));else a=n;a!==n&&(i=t())!==n?(r,s=i,r=o=o.concat(s)):(B=r,r=n)}else B=r,r=n;return r===n&&(r=D()),r}())!==n){for(a=[],S.test(e.charAt(B))?(i=e.charAt(B),B++):(i=n,E(x));i!==n;)a.push(i),S.test(e.charAt(B))?(i=e.charAt(B),B++):(i=n,E(x));a!==n?(t,t=r={type:"sequence",nestedUnits:o}):(B=t,t=n)}else B=t,t=n;else B=t,t=n;if(t===n){for(t=B,r=[],S.test(e.charAt(B))?(o=e.charAt(B),B++):(o=n,E(x));o!==n;)r.push(o),S.test(e.charAt(B))?(o=e.charAt(B),B++):(o=n,E(x));r!==n&&(t,r={type:"sequence",nestedUnits:[]}),t=r}return t}if((r=a())!==n&&B===e.length)return r;throw r!==n&&B<e.length&&E({type:"end"}),U(O,C<e.length?e.charAt(C):null,C<e.length?T(C,C+1):T(C,C))}})&&it.__esModule?it:{default:it};const{parse:ut}=st.default;function ct(e,t={validators:[]}){t.validators=t.validators||[];const r=(0,ke.fromJSON)((0,nt.parse)(e));for(const e of t.validators)e(r);return r}ot=ut,nt.parse=ot;var lt={};Object.defineProperty(lt,"__esModule",{value:!0});var ft=function(e){if(e.altKey||e.ctrlKey)return null;return vt[e.keyCode]||null};lt.keyToMove=ft;const vt={73:(0,s.BareBlockMove)("R"),75:(0,s.BareBlockMove)("R",-1),87:(0,s.BareBlockMove)("B"),79:(0,s.BareBlockMove)("B",-1),83:(0,s.BareBlockMove)("D"),76:(0,s.BareBlockMove)("D",-1),68:(0,s.BareBlockMove)("L"),69:(0,s.BareBlockMove)("L",-1),74:(0,s.BareBlockMove)("U"),70:(0,s.BareBlockMove)("U",-1),72:(0,s.BareBlockMove)("F"),71:(0,s.BareBlockMove)("F",-1),78:(0,s.BareBlockMove)("x",-1),67:(0,s.BareBlockMove)("l"),82:(0,s.BareBlockMove)("l",-1),85:(0,s.BareBlockMove)("r"),77:(0,s.BareBlockMove)("r",-1),88:(0,s.BareBlockMove)("d",1),188:(0,s.BareBlockMove)("d",-1),84:(0,s.BareBlockMove)("x"),89:(0,s.BareBlockMove)("x"),66:(0,s.BareBlockMove)("x",-1),186:(0,s.BareBlockMove)("y"),59:(0,s.BareBlockMove)("y"),65:(0,s.BareBlockMove)("y",-1),80:(0,s.BareBlockMove)("z"),81:(0,s.BareBlockMove)("z",-1),90:(0,s.BareBlockMove)("M",-1),190:(0,s.BareBlockMove)("M",-1)};var ht={};Object.defineProperty(ht,"__esModule",{value:!0});var mt=yt;ht.serializeURLParam=mt;var pt=bt;ht.deserializeURLParam=pt;var dt=function(e){return bt(new URLSearchParams(window.location.search).get(e)||"")};ht.getAlgURLParam=dt;var gt=function(e){const t=new URL("https://alg.cubing.net");if(!e.alg)throw new Error("An alg parameter is required.");t.searchParams.set("alg",yt(e.alg)),e.setup&&t.searchParams.set("setup",yt(e.setup));e.title&&t.searchParams.set("title",e.title);if(e.puzzle){if(!["1x1x1","2x2x2","3x3x3","4x4x4","5x5x5","6x6x6","7x7x7","8x8x8","9x9x9","10x10x10","11x11x11","12x12x12","13x13x13","14x14x14","16x16x16","17x17x17"].includes(e.puzzle))throw new Error(`Invalid puzzle parameter: ${e.puzzle}`);t.searchParams.set("puzzle",e.puzzle)}if(e.stage){if(!["full","cross","F2L","LL","OLL","PLL","CLS","ELS","L6E","CMLL","WV","ZBLL","void"].includes(e.stage))throw new Error(`Invalid stage parameter: ${e.stage}`);t.searchParams.set("stage",e.stage)}if(e.view){if(!["editor","playback","fullscreen"].includes(e.view))throw new Error(`Invalid view parameter: ${e.view}`);t.searchParams.set("view",e.view)}if(e.type){if(!["moves","reconstruction","alg","reconstruction-end-with-setup"].includes(e.type))throw new Error(`Invalid type parameter: ${e.type}`);t.searchParams.set("type",e.type)}return t.toString()};function yt(e){let t=(0,H.algToString)(e);return t=t.replace(/_/g,"&#95;").replace(/ /g,"_"),t=t.replace(/\+/g,"&#2b;"),t=t.replace(/-/g,"&#45;").replace(/'/g,"-"),t}function bt(e){let t=e;return t=t.replace(/-/g,"'").replace(/&#45;/g,"-"),t=t.replace(/\+/g," ").replace(/&#2b;/g,"+"),t=t.replace(/_/g," ").replace(/&#95;/g,"_"),(0,Te.parse)(t)}ht.algCubingNetLink=gt;var wt={};Object.defineProperty(wt,"__esModule",{value:!0});var Mt=void 0;wt.MoveExpander=Mt;var At={};Object.defineProperty(At,"__esModule",{value:!0});var Pt=kt;At.Combine=Pt;var St=function e(t,r,n){if(n<0)return e(t,Lt(t,r),-n);if(0===n)return qt(t);if(1===n)return r;const o=e(t,r,Math.floor(n/2)),a=kt(t,o,o);return n%2==0?a:kt(t,r,a)};At.Multiply=St;var xt=qt;At.IdentityTransformation=xt;var Bt=Lt;At.Invert=Bt;var jt=function(e,t){let r=1;for(const n in e.orbits){const o=e.orbits[n],a=t[n],i=new Array(o.numPieces);for(let e=0;e<o.numPieces;e++)if(!i[e]){let t=e,n=0,s=0;for(;i[t]=!0,n+=a.orientation[t],s+=1,t=a.permutation[t],t!==e;);0!==n&&(s=s*o.orientations/Tt(o.orientations,n)),r=r*s/Tt(r,s)}}return r};At.Order=jt;var Ct=Et;At.EquivalentTransformations=Ct;var Ot=function(e,t,r){return Et(e,kt(e,e.startPieces,t),kt(e,e.startPieces,r))};function kt(e,t,r){const n={};for(const o in e.orbits){const a=e.orbits[o],i=t[o],s=r[o],u=new Array(a.numPieces),c=new Array(a.numPieces);for(let e=0;e<a.numPieces;e++)c[e]=(i.orientation[s.permutation[e]]+s.orientation[e])%a.orientations,u[e]=i.permutation[s.permutation[e]];n[o]={permutation:u,orientation:c}}return n}function qt(e){const t={};for(const r in e.orbits){const n=e.orbits[r],o=new Array(n.numPieces),a=new Array(n.numPieces);for(let e=0;e<n.numPieces;e++)o[e]=e,a[e]=0;const i={permutation:o,orientation:a};t[r]=i}return t}function Lt(e,t){const r={};for(const n in e.orbits){const o=e.orbits[n],a=t[n],i=new Array(o.numPieces),s=new Array(o.numPieces);for(let e=0;e<o.numPieces;e++){const t=a.permutation[e];i[t]=e,s[t]=(o.orientations-a.orientation[e]+o.orientations)%o.orientations}r[n]={permutation:i,orientation:s}}return r}function Tt(e,t){return t?Tt(t,e%t):e}function Et(e,t,r){for(const n in e.orbits){const o=e.orbits[n],a=t[n],i=r[n];for(let e=0;e<o.numPieces;e++){if(a.orientation[e]!==i.orientation[e])return!1;if(a.permutation[e]!==i.permutation[e])return!1}}return!0}function Ut(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}At.EquivalentStates=Ot;function zt(e,t){const r=(0,i.blockMoveToString)(new i.BlockMove(t.outerLayer,t.innerLayer,t.family,1));let n=e.moves[r];if(n||(n=new _t(e).expandSlices(r,t)),!n)throw new Error(`Unknown move family: ${t.family}`);return(0,At.Multiply)(e,n,t.amount)}Mt=class{constructor(){Ut(this,"gripStash",void 0),Ut(this,"moveStash",void 0),Ut(this,"facenames",void 0),Ut(this,"regrip",void 0),this.gripStash={},this.moveStash={},this.regrip={}}setFaceNames(e){this.facenames=e}addGrip(e,t,r,n){const o=[],a=this.gripStash,i=n.moves;for(let a=1;a<=r;a++){let s=1===a&&i[e]||i[""+a+e];if(s||(s=a===r&&i[t]||i[""+(r+1-a)+t],s&&(s=(0,At.Invert)(n,s))),!s)throw new Error("Could not expand axis "+e+" to "+t+" because we are missing a move for slice "+a);o.push(s)}a[e]=o;const s=o.map(e=>(0,At.Invert)(n,e));s.reverse(),a[t]=s}expandSlicesByName(e,t){const r=this.moveStash[e];if(r)return r;try{const r=(0,i.parse)(e);if(1!==r.nestedUnits.length)return;const n=r.nestedUnits[0];return this.expandSlices(e,n,t)}catch(e){return}}unswizzle(e){if(this.regrip[e])return this.regrip[e];if(!this.facenames)return e;e.length>1&&e[0]<="Z"&&("w"===e[e.length-1]||"v"===e[e.length-1])&&(e=e.substr(0,e.length-1));const t=this.splitByFaceNames(e,this.facenames);if(t)for(let r=0;r<t.length;r++){let n="";for(let e=0;e<t.length;e++)n+=t[(r+e)%t.length];if(this.gripStash[n])return this.regrip[e]=n,n}return e}expandSlices(e,t,r){const n=this.moveStash[e];if(n)return n;const o=this.gripStash,a=t.family;let i=a,s=!1,u=!1;/[a-z]/.test(a)&&(s=!0,i=a.toUpperCase()),a.length>1&&a.endsWith("w")&&(s=!0,i=a.substring(0,a.length-1)),a.length>1&&a.endsWith("v")&&(u=!0,i=a.substring(0,a.length-1));let c=o[i];if(!c&&this.facenames&&(i=this.unswizzle(i),c=o[i]),!c)return;let l=t.outerLayer,f=t.innerLayer;if(void 0===f){if(void 0!==l)return;l=1,f=s?2:1,u&&(f=o[i].length)}else void 0===l&&(l=s?1:f);if(f<l)return;if(l>o[i].length)return;let v=c[l-1];for(let e=l+1;e<=f;e++)v=(0,At.Combine)(r,v,c[e-1]);return this.moveStash[e]=v,v}splitByFaceNames(e,t){const r=[];let n=0;for(e=e.toUpperCase();n<e.length;){let o=!1;for(const a of t)if(e.substr(n).startsWith(a)){r.push(a),n+=a.length,o=!0;break}if(!o)return}return r}},wt.MoveExpander=Mt;class _t{constructor(e){this.definition=e,function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"state",void 0),this.state=(0,At.IdentityTransformation)(e)}reset(){this.state=(0,At.IdentityTransformation)(this.definition)}serialize(){let e="";for(const t in this.definition.orbits)e+=t+"\n",e+=this.state[t].permutation.join(" ")+"\n",e+=this.state[t].orientation.join(" ")+"\n";return e=e.slice(0,e.length-1),e}applyBlockMove(e){this.state=(0,At.Combine)(this.definition,this.state,zt(this.definition,e))}applyAlg(e){for(const t of(0,i.expand)(e).nestedUnits)this.applyBlockMove(t)}applyMove(e){let t=this.definition.moves[e];if(t||(t=this.expandSlicesByName(e)),!t)throw new Error(`Unknown move: ${e}`);return this.state=(0,At.Combine)(this.definition,this.state,t),this}getMoveExpander(e){let t=this.definition.moveExpander;return e&&!t&&(t=new wt.MoveExpander,this.definition.moveExpander=t),t}setFaceNames(e){const t=this.getMoveExpander(!0);t&&t.setFaceNames(e)}addGrip(e,t,r){const n=this.getMoveExpander(!0);return n?n.addGrip(e,t,r,this.definition):void 0}expandSlices(e,t){const r=this.getMoveExpander(!1);return r?r.expandSlices(e,t,this.definition):void 0}expandSlicesByName(e){const t=this.getMoveExpander(!1);return t?t.expandSlicesByName(e,this.definition):void 0}unswizzle(e){const t=this.getMoveExpander(!0);return t?t.unswizzle(e):e}}a=_t,n.KPuzzle=a;var Nt={};Object.defineProperty(Nt,"__esModule",{value:!0});var It=(Rt=void 0,$t=Nt.Canonicalize=Rt,Nt.SearchSequence=$t);function Ft(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Nt.CanonicalSequenceIterator=It;class Gt{constructor(e,t){this.base=e,this.twist=t}getTransformation(e){return e.transforms[this.base][this.twist]}asString(e){const t=e.moveorder[this.base];let r=this.twist%t;for(;r+r>t;)r-=t;for(;r+r<=-t;)r+=t;const n=e.movenames[this.base];if(1===r)return n;if(-1===r)return n+"'";if(r>0)return n+r;if(r<0)return n+-r+"'";throw new Error("Stringifying null move?")}}var Rt=class{constructor(e){this.def=e,Ft(this,"commutes",[]),Ft(this,"moveorder",[]),Ft(this,"movenames",[]),Ft(this,"transforms",[]),Ft(this,"moveindex",{}),Ft(this,"baseMoveCount",void 0);const t=e.moves,r=(0,At.IdentityTransformation)(e);for(const e in t)this.moveindex[e]=this.movenames.length,this.movenames.push(e),this.transforms.push([r,t[e]]);this.baseMoveCount=this.movenames.length;for(let t=0;t<this.baseMoveCount;t++){this.commutes.push([]);const r=this.transforms[t][1];for(let n=0;n<this.baseMoveCount;n++){const o=this.transforms[n][1],a=(0,At.Combine)(e,r,o),i=(0,At.Combine)(e,o,r);this.commutes[t][n]=(0,At.EquivalentTransformations)(e,a,i)}}for(let t=0;t<this.baseMoveCount;t++){const n=this.transforms[t][1];let o=n,a=1;for(let i=2;!(0,At.EquivalentTransformations)(e,r,o);i++)a++,o=(0,At.Combine)(e,o,n),this.transforms[t].push(o);this.moveorder[t]=a}}blockMoveToInternalMove(e){const t=(0,i.modifiedBlockMove)(e,{amount:1}),r=(0,i.blockMoveToString)(t);if(!(r in this.def.moves))throw new Error("! move "+r+" not in def.");const n=this.moveindex[r],o=this.moveorder[n];let a=e.amount%o;return a<0&&(a=(a+o)%o),new Gt(n,a)}sequenceToSearchSequence(e,t){const r=new Dt(this,t);for(const t of e.nestedUnits)r.appendOneMove(this.blockMoveToInternalMove(t));return r}mergeSequenceToSearchSequence(e,t){const r=new Dt(this,t);for(const t of e.nestedUnits)r.mergeOneMove(this.blockMoveToInternalMove(t));return r}};Nt.Canonicalize=Rt;class Dt{constructor(e,t){this.canon=e,Ft(this,"moveseq",[]),Ft(this,"trans",void 0),this.trans=t||(0,At.IdentityTransformation)(e.def)}clone(){const e=new Dt(this.canon,this.trans);return e.moveseq=[...this.moveseq],e}mergeOneMove(e){const t=this.onlyMergeOneMove(e);return this.trans=(0,At.Combine)(this.canon.def,this.trans,e.getTransformation(this.canon)),t}appendOneMove(e){return this.moveseq.push(e),this.trans=(0,At.Combine)(this.canon.def,this.trans,e.getTransformation(this.canon)),1}popMove(){const e=this.moveseq.pop();if(!e)throw new Error("Can't pop an empty sequence");return this.trans=(0,At.Combine)(this.canon.def,this.trans,this.canon.transforms[e.base][this.canon.moveorder[e.base]-e.twist]),1}oneMoreTwist(){const e=this.moveseq[this.moveseq.length-1];return this.trans=(0,At.Combine)(this.canon.def,this.trans,this.canon.transforms[e.base][1]),this.moveseq[this.moveseq.length-1]=new Gt(e.base,e.twist+1),0}onlyMergeOneMove(e){let t=this.moveseq.length-1;for(;t>=0;){if(e.base===this.moveseq[t].base){const r=this.canon.moveorder[e.base];let n=(e.twist+this.moveseq[t].twist)%r;return n<0&&(n=(n+r)%r),0===n?(this.moveseq.splice(t,1),-1):(this.moveseq[t]=new Gt(e.base,n),0)}if(!this.canon.commutes[e.base][this.moveseq[t].base])break;t--}return this.moveseq.push(e),1}mergeSequence(e){let t=this.moveseq.length;for(let r=0;r<e.moveseq.length;r++){const n=e.moveseq[r];t+=this.onlyMergeOneMove(n)}return this.trans=(0,At.Combine)(this.canon.def,this.trans,e.trans),t}getSequenceAsString(){const e=[];for(const t of this.moveseq)e.push(t.asString(this.canon));return e.join(" ")}}var $t=Dt;Nt.SearchSequence=$t;It=class{constructor(e,t){this.canon=e,Ft(this,"ss",void 0),Ft(this,"targetLength",void 0),this.ss=new Dt(e,t),this.targetLength=0}nextState(e,t){const r=[];for(const n of t){if(n===e)return null;if(this.canon.commutes[n][e]){if(e<n)return null;r.push(n)}else;}return r}*genSequence(e,t){if(0===e)yield this.ss;else for(let r=0;r<this.canon.baseMoveCount;r++){const n=this.nextState(r,t);if(n){n.push(r);for(let t=1;t<this.canon.moveorder[r];t++)this.ss.appendOneMove(new Gt(r,t)),yield*this.genSequence(e-1,n),this.ss.popMove()}}return null}*generator(){for(let e=0;;e++)yield*this.genSequence(e,[])}*genSequenceTree(e){if((yield this.ss)>0)return null;for(let t=0;t<this.canon.baseMoveCount;t++){const r=this.nextState(t,e);if(r){r.push(t);for(let e=1;e<this.canon.moveorder[t];e++)this.ss.appendOneMove(new Gt(t,e)),yield*this.genSequenceTree(r),this.ss.popMove()}}return null}},Nt.CanonicalSequenceIterator=It;var Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});var Zt=void 0;Vt.Puzzles=Zt;var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});var Wt=(Ht=void 0,Xt=Kt.Cube222=Ht,er=Kt.Cube333=Xt,rr=Kt.Pyraminx=er,Kt.Square1=rr);Kt.Clock=Wt;const Jt={};var Ht=Jt;Kt.Cube222=Ht,Jt.svg="cube222SVG";const Qt={};var Xt=Qt;Kt.Cube333=Xt,Qt.svg="cube333SVG";const Yt={};var er=Yt;Kt.Pyraminx=er,Yt.svg="pyraminxSVG";const tr={};var rr=tr;Kt.Square1=rr,tr.svg="square1SVG";const nr={};Wt=nr,Kt.Clock=Wt,nr.svg="clockSVG",Zt={"2x2x2":Kt.Cube222,"3x3x3":Kt.Cube333,pyraminx:Kt.Pyraminx,sq1:Kt.Square1,clock:Kt.Clock},Vt.Puzzles=Zt;var or={};Object.defineProperty(or,"__esModule",{value:!0}),Object.defineProperty(or,"parse",{enumerable:!0,get:function(){return ar.parse}});var ar={};Object.defineProperty(ar,"__esModule",{value:!0});var ir=void 0;ar.parse=ir;var sr={};Object.defineProperty(sr,"__esModule",{value:!0});var ur=void 0;sr.parse=ur;function cr(e,t,r,n){this.message=e,this.expected=t,this.found=r,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,cr)}!function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(cr,Error),cr.buildMessage=function(e,t){var r={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?a(e.parts[t][0])+"-"+a(e.parts[t][1]):a(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,o,a=new Array(e.length);for(t=0;t<e.length;t++)a[t]=(o=e[t],r[o.type](o));if(a.sort(),a.length>0){for(t=1,n=1;t<a.length;t++)a[t-1]!==a[t]&&(a[n]=a[t],n++);a.length=n}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."};var lr=function(e){return e&&e.__esModule?e:{default:e}}({SyntaxError:cr,parse:function(e,t){t=void 0!==t?t:{};var r,n={},o={start:L},a=L,i=function(e){return function(e){for(const t in e.moves){const r=e.moves[t];for(const t in e.orbits){const e=r[t],n=e.orientation,o=e.permutation,a=new Array(n.length);for(let e=0;e<o.length;e++)a[e]=n[o[e]];e.orientation=a}}return e}(e)},s=/^[A-Za-z0-9<>]/,u=j([["A","Z"],["a","z"],["0","9"],"<",">"],!1,!1),c=/^[A-Za-z]/,l=j([["A","Z"],["a","z"]],!1,!1),f=/^[A-Za-z0-9]/,v=j([["A","Z"],["a","z"],["0","9"]],!1,!1),h=/^[0-9]/,m=j([["0","9"]],!1,!1),p=B(" ",!1),d=B("Name",!1),g=B("Set",!1),y=B("\n",!1),b=B("Solved",!1),w=B("End",!1),M=B("Move",!1),A=0,P=[{line:1,column:1}],S=0,x=[];if("startRule"in t){if(!(t.startRule in o))throw new Error("Can't start parsing from rule \""+t.startRule+'".');a=o[t.startRule]}function B(e,t){return{type:"literal",text:e,ignoreCase:t}}function j(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function C(t){var r,n=P[t];if(n)return n;for(r=t-1;!P[r];)r--;for(n={line:(n=P[r]).line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return P[t]=n,n}function O(e,t){var r=C(e),n=C(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function k(e){A<S||(A>S&&(S=A,x=[]),x.push(e))}function q(e,t,r){return new cr(cr.buildMessage(e,t),e,t,r)}function L(){var t,r;return t=A,(r=function(){var t,r,o,a,i;t=A,(r=function(){var t,r,o;t=A,"Name"===e.substr(A,4)?(r="Name",A+=4):(r=n,k(d));r!==n&&z()!==n&&(o=T())!==n?(t,t=r=o):(A=t,t=n);return t}())!==n&&I()!==n&&(o=function e(){var t,r,o;t=A,(r=_())!==n&&N()!==n&&(o=e())!==n?(t,(i=o)[(a=r)[0]]=a[1],t=r=i):(A=t,t=n);var a,i;t===n&&(t=A,(r=_())!==n&&(t,r=function(e){const t={};return t[e[0]]=e[1],t}(r)),t=r);return t}())!==n&&I()!==n&&(a=function(){var t,r,o,a;t=A,"Solved"===e.substr(A,6)?(r="Solved",A+=6):(r=n,k(b));r!==n&&N()!==n&&(o=D())!==n&&N()!==n?("End"===e.substr(A,3)?(a="End",A+=3):(a=n,k(w)),a!==n?(t,t=r=o):(A=t,t=n)):(A=t,t=n);return t}())!==n&&I()!==n&&(i=function e(){var t,r,o;t=A,(r=$())!==n&&I()!==n&&(o=e())!==n?(t,(i=o)[(a=r)[0]]=a[1],t=r=i):(A=t,t=n);var a,i;t===n&&(t=A,(r=$())!==n&&(t,r=function(e){const t={};return t[e[0]]=e[1],t}(r)),t=r);return t}())!==n&&function(){var t,r;t=[],10===e.charCodeAt(A)?(r="\n",A++):(r=n,k(y));for(;r!==n;)t.push(r),10===e.charCodeAt(A)?(r="\n",A++):(r=n,k(y));return t}()!==n?(t,t=r={name:r,orbits:o,moves:i,startPieces:a}):(A=t,t=n);return t}())!==n&&(t,r=i(r)),t=r}function T(){var t,r,o;if(t=A,r=[],s.test(e.charAt(A))?(o=e.charAt(A),A++):(o=n,k(u)),o!==n)for(;o!==n;)r.push(o),s.test(e.charAt(A))?(o=e.charAt(A),A++):(o=n,k(u));else r=n;return r!==n&&(t,r=r.join("")),t=r}function E(){var t,r,o,a;if(t=A,c.test(e.charAt(A))?(r=e.charAt(A),A++):(r=n,k(l)),r!==n){for(o=[],f.test(e.charAt(A))?(a=e.charAt(A),A++):(a=n,k(v));a!==n;)o.push(a),f.test(e.charAt(A))?(a=e.charAt(A),A++):(a=n,k(v));o!==n?(t,t=r=[r].concat(o).join("")):(A=t,t=n)}else A=t,t=n;return t}function U(){var t,r,o;if(t=A,r=[],h.test(e.charAt(A))?(o=e.charAt(A),A++):(o=n,k(m)),o!==n)for(;o!==n;)r.push(o),h.test(e.charAt(A))?(o=e.charAt(A),A++):(o=n,k(m));else r=n;return r!==n&&(t,r=parseInt(r.join(""),10)),t=r}function z(){var t;return 32===e.charCodeAt(A)?(t=" ",A++):(t=n,k(p)),t}function _(){var t,r,o,a,i;return t=A,"Set"===e.substr(A,3)?(r="Set",A+=3):(r=n,k(g)),r!==n&&z()!==n&&(o=E())!==n&&z()!==n&&(a=U())!==n&&z()!==n&&(i=U())!==n?(t,t=r=[o,{numPieces:a,orientations:i}]):(A=t,t=n),t}function N(){var t;return 10===e.charCodeAt(A)?(t="\n",A++):(t=n,k(y)),t}function I(){var t,r;if(t=[],10===e.charCodeAt(A)?(r="\n",A++):(r=n,k(y)),r!==n)for(;r!==n;)t.push(r),10===e.charCodeAt(A)?(r="\n",A++):(r=n,k(y));else t=n;return t}function F(){var e,t,r;return e=A,(t=U())!==n&&z()!==n&&(r=F())!==n?(e,e=t=[t].concat(r)):(A=e,e=n),e===n&&(e=A,(t=U())!==n&&(e,t=function(e){return[e]}(t)),e=t),e}function G(){var e,t;return e=A,(t=F())!==n&&(e,t=t.map(e=>e-1)),e=t}function R(){var e,t,r,o;return e=A,(t=E())!==n&&N()!==n&&(r=G())!==n&&N()!==n&&(o=F())!==n?(e,e=t=[t,{permutation:r,orientation:o}]):(A=e,e=n),e===n&&(e=A,(t=E())!==n&&N()!==n&&(r=G())!==n?(e,e=t=function(e,t){return[e,{permutation:t,orientation:new Array(t.length).fill(0)}]}(t,r)):(A=e,e=n)),e}function D(){var e,t,r,o,a;return e=A,(t=R())!==n&&N()!==n&&(r=D())!==n?(e,(a=r)[(o=t)[0]]=o[1],e=t=a):(A=e,e=n),e===n&&(e=A,(t=R())!==n&&(e,t=function(e){const t={};return t[e[0]]=e[1],t}(t)),e=t),e}function $(){var t,r,o,a,i;return t=A,"Move"===e.substr(A,4)?(r="Move",A+=4):(r=n,k(M)),r!==n&&z()!==n&&(o=T())!==n&&N()!==n&&(a=D())!==n&&N()!==n?("End"===e.substr(A,3)?(i="End",A+=3):(i=n,k(w)),i!==n?(t,t=r=[o,a]):(A=t,t=n)):(A=t,t=n),t}if((r=a())!==n&&A===e.length)return r;throw r!==n&&A<e.length&&k({type:"end"}),q(x,S<e.length?e.charAt(S):null,S<e.length?O(S,S+1):O(S,S))}});const{parse:fr}=lr.default;ur=fr,sr.parse=ur,ir=sr.parse,ar.parse=ir;var vr={};Object.defineProperty(vr,"__esModule",{value:!0});var hr=void 0;function mr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}vr.SVG=hr;let pr=0;hr=class{constructor(e){if(this.kPuzzleDefinition=e,mr(this,"element",void 0),mr(this,"gradientDefs",void 0),mr(this,"originalColors",{}),mr(this,"gradients",{}),mr(this,"svgID",void 0),!e.svg)throw new Error(`No SVG definition for puzzle type: ${e.name}`);this.svgID=(pr+=1,"svg"+pr.toString()),this.element=document.createElement("div"),this.element.classList.add("svg-wrapper"),this.element.innerHTML=e.svg;const t=this.element.querySelector("svg");if(!t)throw new Error("Could not get SVG element");if("http://www.w3.org/2000/svg"!==t.namespaceURI)throw new Error("Unexpected XML namespace");t.style.maxWidth="100%",t.style.maxHeight="100%",this.gradientDefs=document.createElementNS("http://www.w3.org/2000/svg","defs"),t.insertBefore(this.gradientDefs,t.firstChild);for(const t in e.orbits){const r=e.orbits[t];for(let e=0;e<r.numPieces;e++)for(let n=0;n<r.orientations;n++){const r=this.elementID(t,e,n),o=this.elementByID(r),a=o.style.fill;this.originalColors[r]=a,this.gradients[r]=this.newGradient(r,a),this.gradientDefs.appendChild(this.gradients[r]),o.setAttribute("style",`fill: url(#grad-${this.svgID}-${r})`)}}}drawKPuzzle(e,t,r){this.draw(e.definition,e.state,t,r)}draw(e,t,r,n){for(const o in e.orbits){const a=e.orbits[o],i=t[o],s=r?r[o]:null;for(let e=0;e<a.numPieces;e++)for(let t=0;t<a.orientations;t++){const r=this.elementID(o,e,t),u=this.elementID(o,i.permutation[e],(a.orientations-i.orientation[e]+t)%a.orientations);let c=!1;if(s){const i=this.elementID(o,s.permutation[e],(a.orientations-s.orientation[e]+t)%a.orientations);u===i&&(c=!0);const l=100*(1-(n=n||0)*n*(2-n*n));this.gradients[r].children[0].setAttribute("stop-color",this.originalColors[u]),this.gradients[r].children[1].setAttribute("stop-color",this.originalColors[u]),this.gradients[r].children[1].setAttribute("offset",`${Math.max(l-5,0)}%`),this.gradients[r].children[2].setAttribute("offset",`${Math.max(l-5,0)}%`),this.gradients[r].children[3].setAttribute("offset",`${l}%`),this.gradients[r].children[4].setAttribute("offset",`${l}%`),this.gradients[r].children[4].setAttribute("stop-color",this.originalColors[i]),this.gradients[r].children[5].setAttribute("stop-color",this.originalColors[i])}else c=!0;c&&(this.gradients[r].children[0].setAttribute("stop-color",this.originalColors[u]),this.gradients[r].children[1].setAttribute("stop-color",this.originalColors[u]),this.gradients[r].children[1].setAttribute("offset","100%"),this.gradients[r].children[2].setAttribute("offset","100%"),this.gradients[r].children[3].setAttribute("offset","100%"),this.gradients[r].children[4].setAttribute("offset","100%"))}}}newGradient(e,t){const r=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");r.setAttribute("id",`grad-${this.svgID}-${e}`),r.setAttribute("r","70.7107%");const n=[{offset:0,color:t},{offset:0,color:t},{offset:0,color:"black"},{offset:0,color:"black"},{offset:0,color:t},{offset:100,color:t}];for(const e of n){const t=document.createElementNS("http://www.w3.org/2000/svg","stop");t.setAttribute("offset",`${e.offset}%`),t.setAttribute("stop-color",e.color),t.setAttribute("stop-opacity","1"),r.appendChild(t)}return r}elementID(e,t,r){return e+"-l"+t+"-o"+r}elementByID(e){return this.element.querySelector("#"+e)}},vr.SVG=hr;
//# sourceMappingURL=index.js.map
